# 应用程序包安装卸载与更新

## 安装卸载

通过调试命令bm安装卸载应用

## 更新

更新app.json5中的versionCode，与首次上架发布流程一致


## 应用安装更新时的一致性校验

复杂大型的应用，不同的团队负责一个或多个模块，在应用安装和更新时需要进行一致性校验

应用在安装更新时需要对签名证书，配置文件进行一致性校验

### 签名证书的一致性校验

appId组成方式为bundleName_公钥的base64编码。base64编码是一种将二进制数据转化为64个ASCII字符的编码方式，用于安全传输或存储二进制数据到文本环境中。例如可以将图片以base64编码的形式直接嵌入HTML中。

appIdentifier为应用的唯一标识，AGC创建应用时分配的APP ID，它是云端统一分配的唯一且随机的字符串。appIdentifier在应用的全生命周期中都不会发生变化，包括版本升级，证书变更，开发者公私钥变更，应用转移等等

安装时，证书中的appId和appIdentifier需要保持一致，更新时appId和appIdentifier只要有一个相同即可

appDistributionType 标识应用的发布上架类型，如类型可以为企业MDM（Mobile Device Management）,专门运行企业专有设备上

appProvisionType provison通常指证书，appProvisionType标识应用签名证书类型，可以为debug和release

apl (Ability Privilege Level) 元能力权限等级，分为`normal，system_basic，system_core`

### 配置文件的一致性校验

安装和更新时配置文件中的bundleName需保持一致，更新时必须确保新版本的versionCode比旧版本的高

apiReleaseType 标识应用运行时的API类型，取值为`CanaryN`, `BetaN`或`Release`。这个配置在编译构建的时候会根据当前使用的SDK类型自动生成。

Canary翻译为金丝雀，过去矿工会使用金丝雀来检测矿洞中的有毒气体。在软件领域也是类似，先向少量的用户推送，无问题后再向大量的用户推送。

Canary的下一个阶段一般为Beta版本，此时软件功能较为稳定，少量用户发觉不出软件的新问题，需要增加用户量，来完善该软件的边界情况。可以将Canary理解为小白鼠，小范围测试的不稳定版本。Beta代表功能接近稳定的版本，可以大范围测试。

targetBundleName 成为哪个目标应用的覆盖包（overlay），可以动态地替换目标应用的部分资源

targetPriority和targetBundleName搭配使用，当有多个覆盖包冲突时，根据优先级进行选择

bundleType 标识应用的bundle类型，取值有app，atomicService，shared，appPlugin

installationFree 标识当前Module是否支持免安装，当bundleType为元服务的类型时，需要为true

debug 是否支持IDE断点调试

moduleType 模块的类型，entry，feature，har，shared
